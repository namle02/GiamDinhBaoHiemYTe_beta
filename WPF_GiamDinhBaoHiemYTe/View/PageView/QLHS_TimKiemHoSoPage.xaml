<UserControl
    x:Class="WPF_GiamDinhBaoHiem.View.PageView.QLHS_TimKiemHoSoPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="clr-namespace:WPF_GiamDinhBaoHiem.Converter"
    xmlns:control="clr-namespace:WPF_GiamDinhBaoHiem.View.ControlView"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    x:Name="Root"
    Background="{DynamicResource MaterialDesignPaper}"
    mc:Ignorable="d">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <converter:StringToVisibilityConverter x:Key="StringToVis" />
        <converter:ErrorToColorConverter x:Key="ErrorToColorConverter" />
        <converter:ErrorContentToColorConverter x:Key="ErrorContentToColorConverter" />
        <converter:ErrorContentBackgroundConverter x:Key="ErrorContentBackgroundConverter" />
        <converter:ErrorContentBorderConverter x:Key="ErrorContentBorderConverter" />
        <converter:FieldErrorConverter x:Key="FieldErrorConverter" />
        <converter:GenderConverter x:Key="GenderConverter" />
        <converter:ErrorTextConverter x:Key="ErrorTextConverter" />
        <converter:ProgressBarWidthConverter x:Key="ProgressBarWidthConverter" />

        <!--  Style cho TextBlock trong XML2-5 Ä‘á»ƒ cÃ³ mÃ u Ä‘á» khi lá»—i  -->
        <Style x:Key="ErrorTextBlockStyle" TargetType="TextBlock">
            <Setter Property="Foreground">
                <Setter.Value>
                    <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                        <Binding Path="Id" />
                        <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                    </MultiBinding>
                </Setter.Value>
            </Setter>
        </Style>


        <Style x:Key="CellTextBlock" TargetType="TextBlock">
            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
            <Setter Property="ToolTip" Value="{Binding Text, RelativeSource={RelativeSource Self}}" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="ChipCount" TargetType="Border">
            <Setter Property="CornerRadius" Value="10" />
            <Setter Property="Padding" Value="6,2" />
            <Setter Property="Background" Value="{DynamicResource PrimaryHueLightBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource PrimaryHueMidBrush}" />
            <Setter Property="BorderThickness" Value="1" />
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Background" Value="#FAFAFA" />
            <Setter Property="Padding" Value="8,6" />
        </Style>

        <Style TargetType="DataGrid">
            <Setter Property="RowHeaderWidth" Value="0" />
            <Setter Property="AlternatingRowBackground" Value="#11000000" />
            <Setter Property="AlternationCount" Value="2" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="EnableRowVirtualization" Value="True" />
            <Setter Property="EnableColumnVirtualization" Value="True" />
        </Style>

        <!--  Pastel header colors per XML tab  -->
        <SolidColorBrush x:Key="Xml1Header" Color="#E6F4FF" />
        <SolidColorBrush x:Key="Xml2Header" Color="#FFF5E6" />
        <SolidColorBrush x:Key="Xml3Header" Color="#E8FFF3" />
        <SolidColorBrush x:Key="Xml4Header" Color="#FDEDF2" />
        <SolidColorBrush x:Key="Xml5Header" Color="#F3FDE8" />
        <SolidColorBrush x:Key="Xml6Header" Color="#EDEBFF" />
        <SolidColorBrush x:Key="Xml7Header" Color="#FFEFE6" />
        <SolidColorBrush x:Key="Xml8Header" Color="#E6FFF9" />
        <SolidColorBrush x:Key="Xml9Header" Color="#FFF0F5" />
        <SolidColorBrush x:Key="Xml10Header" Color="#FFFBE6" />
        <SolidColorBrush x:Key="Xml11Header" Color="#EAF2FF" />
        <SolidColorBrush x:Key="Xml12Header" Color="#F6E6FF" />
        <SolidColorBrush x:Key="Xml13Header" Color="#E6FFF0" />
        <SolidColorBrush x:Key="Xml14Header" Color="#FFE6F2" />
        <SolidColorBrush x:Key="Xml15Header" Color="#E6F0FF" />
        <SolidColorBrush x:Key="XmlDefaultHeader" Color="#F3F4F6" />

        <!--  Colored TabItem header style  -->
        <Style x:Key="ColoredTabItem" TargetType="TabItem">
            <Setter Property="Margin" Value="2,0,2,0" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="Background" Value="{StaticResource XmlDefaultHeader}" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border
                            x:Name="Bd"
                            Padding="0"
                            Background="{TemplateBinding Background}"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            CornerRadius="6,6,0,0">
                            <ContentPresenter
                                x:Name="Content"
                                Margin="10,4"
                                ContentSource="Header"
                                RecognizesAccessKey="True" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#9CA3AF" />
                                <Setter TargetName="Bd" Property="RenderOptions.BitmapScalingMode" Value="HighQuality" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.6" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <!--  XML1 Tab Error Highlighting  -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML1" />
                        <Condition Binding="{Binding DataContext.HasXml1Error, RelativeSource={RelativeSource AncestorType=Page}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="Red" />
                    <Setter Property="Foreground" Value="White" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML1">
                    <Setter Property="Background" Value="{StaticResource Xml1Header}" />
                </DataTrigger>

                <!--  XML2 Tab Error Highlighting  -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML2" />
                        <Condition Binding="{Binding DataContext.HasOverlayXml2Error, RelativeSource={RelativeSource AncestorType=Page}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="Red" />
                    <Setter Property="Foreground" Value="White" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML2">
                    <Setter Property="Background" Value="{StaticResource Xml2Header}" />
                </DataTrigger>

                <!--  XML3 Tab Error Highlighting  -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML3" />
                        <Condition Binding="{Binding DataContext.HasOverlayXml3Error, RelativeSource={RelativeSource AncestorType=Page}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="Red" />
                    <Setter Property="Foreground" Value="White" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML3">
                    <Setter Property="Background" Value="{StaticResource Xml3Header}" />
                </DataTrigger>

                <!--  XML4 Tab Error Highlighting  -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML4" />
                        <Condition Binding="{Binding DataContext.HasOverlayXml4Error, RelativeSource={RelativeSource AncestorType=Page}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="Red" />
                    <Setter Property="Foreground" Value="White" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML4">
                    <Setter Property="Background" Value="{StaticResource Xml4Header}" />
                </DataTrigger>

                <!--  XML5 Tab Error Highlighting  -->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML5" />
                        <Condition Binding="{Binding DataContext.HasOverlayXml5Error, RelativeSource={RelativeSource AncestorType=Page}}" Value="True" />
                    </MultiDataTrigger.Conditions>
                    <Setter Property="Background" Value="Red" />
                    <Setter Property="Foreground" Value="White" />
                </MultiDataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML5">
                    <Setter Property="Background" Value="{StaticResource Xml5Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML6">
                    <Setter Property="Background" Value="{StaticResource Xml6Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML7">
                    <Setter Property="Background" Value="{StaticResource Xml7Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML8">
                    <Setter Property="Background" Value="{StaticResource Xml8Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML9">
                    <Setter Property="Background" Value="{StaticResource Xml9Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML10">
                    <Setter Property="Background" Value="{StaticResource Xml10Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML11">
                    <Setter Property="Background" Value="{StaticResource Xml11Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML12">
                    <Setter Property="Background" Value="{StaticResource Xml12Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML13">
                    <Setter Property="Background" Value="{StaticResource Xml13Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML14">
                    <Setter Property="Background" Value="{StaticResource Xml14Header}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource Self}, Path=Header}" Value="XML15">
                    <Setter Property="Background" Value="{StaticResource Xml15Header}" />
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid>
        <!--  Ná»˜I DUNG CHÃNH  -->
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="8" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  SEARCH  -->
            <materialDesign:Card Padding="16">
                <StackPanel>
                    <!--  HÃ ng 1: Toggle button vÃ  cÃ¡c button actions  -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <!--  Segmented Control: TÃ¬m kiáº¿m theo MÃ£ LiÃªn Káº¿t vs MÃ£ Bá»‡nh NhÃ¢n  -->
                        <Border
                            Grid.Column="0"
                            Height="44"
                            MinWidth="450"
                            Margin="0,0,16,0"
                            Padding="4"
                            Background="#F3F4F6"
                            BorderBrush="#D1D5DB"
                            BorderThickness="1"
                            CornerRadius="8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <!--  TÃ¬m theo MÃ£ LiÃªn Káº¿t Button  -->
                                <Button
                                    Grid.Column="0"
                                    Margin="0,0,2,0"
                                    Padding="10,6"
                                    Command="{Binding ToggleSearchModeCommand}">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource MaterialDesignFlatButton}" TargetType="Button">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="#6B7280" />
                                            <Setter Property="FontWeight" Value="Normal" />
                                            <Setter Property="materialDesign:ButtonAssist.CornerRadius" Value="6" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSearchByMaBn}" Value="False">
                                                    <Setter Property="Background" Value="White" />
                                                    <Setter Property="Foreground" Value="#1F2937" />
                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                    <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                    <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                        <materialDesign:PackIcon
                                            Width="18"
                                            Height="18"
                                            Margin="0,0,6,0"
                                            VerticalAlignment="Center"
                                            Kind="Link" />
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="TÃ¬m theo MÃ£ liÃªn káº¿t" />
                                    </StackPanel>
                                </Button>

                                <!--  TÃ¬m theo MÃ£ Bá»‡nh NhÃ¢n Button  -->
                                <Button
                                    Grid.Column="1"
                                    Margin="2,0,0,0"
                                    Padding="10,6"
                                    Command="{Binding ToggleSearchModeCommand}">
                                    <Button.Style>
                                        <Style BasedOn="{StaticResource MaterialDesignFlatButton}" TargetType="Button">
                                            <Setter Property="Background" Value="Transparent" />
                                            <Setter Property="Foreground" Value="#6B7280" />
                                            <Setter Property="FontWeight" Value="Normal" />
                                            <Setter Property="materialDesign:ButtonAssist.CornerRadius" Value="6" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSearchByMaBn}" Value="True">
                                                    <Setter Property="Background" Value="White" />
                                                    <Setter Property="Foreground" Value="#1F2937" />
                                                    <Setter Property="FontWeight" Value="SemiBold" />
                                                    <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Button.Style>
                                    <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                        <materialDesign:PackIcon
                                            Width="18"
                                            Height="18"
                                            Margin="0,0,6,0"
                                            VerticalAlignment="Center"
                                            Kind="AccountCircle" />
                                        <TextBlock
                                            VerticalAlignment="Center"
                                            FontSize="13"
                                            Text="TÃ¬m theo MÃ£ bá»‡nh nhÃ¢n" />
                                    </StackPanel>
                                </Button>
                            </Grid>
                        </Border>

                        <!--  Action buttons  -->
                        <StackPanel
                            Grid.Column="2"
                            VerticalAlignment="Center"
                            Orientation="Horizontal">
                            <Button
                                Height="40"
                                MinWidth="120"
                                Margin="8,0,0,0"
                                Command="{Binding ImportExcelAndProcessCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="16"
                                        Height="16"
                                        Margin="0,0,4,0"
                                        Kind="FileExcel" />
                                    <TextBlock FontSize="14" Text="Import Excel" />
                                </StackPanel>
                            </Button>
                            <Button
                                Height="40"
                                MinWidth="120"
                                Margin="8,0,0,0"
                                Command="{Binding ExportToExcelCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="16"
                                        Height="16"
                                        Margin="0,0,4,0"
                                        Kind="Download" />
                                    <TextBlock FontSize="14" Text="Export Excel" />
                                </StackPanel>
                            </Button>
                            <Button
                                Height="40"
                                MinWidth="100"
                                Margin="8,0,0,0"
                                Command="{Binding ClearAllCacheCommand}"
                                Style="{StaticResource MaterialDesignOutlinedButton}">
                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="16"
                                        Height="16"
                                        Margin="0,0,4,0"
                                        Kind="Refresh" />
                                    <TextBlock FontSize="14" Text="LÃ m má»›i" />
                                </StackPanel>
                            </Button>
                            <Border Style="{StaticResource ChipCount}">
                                <TextBlock>
                                    <Run Text="Káº¿t quáº£: " />
                                    <Run Text="{Binding ValidationResults.Count, Mode=OneWay}" />
                                </TextBlock>
                            </Border>
                        </StackPanel>
                    </Grid>

                    <!--  HÃ ng 2: Search Box (theo MA_LK) - áº¨n khi IsSearchByMaBn = True  -->
                    <Grid>
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="Visibility" Value="Visible" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsSearchByMaBn}" Value="True">
                                        <Setter Property="Visibility" Value="Collapsed" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <TextBox
                            x:Name="SearchTextBox"
                            Grid.Column="0"
                            MinHeight="48"
                            Margin="0,0,8,0"
                            VerticalContentAlignment="Center"
                            materialDesign:HintAssist.Hint="Nháº­p mÃ£ liÃªn káº¿t  rá»“i nháº¥n Enter"
                            materialDesign:TextFieldAssist.HasClearButton="True"
                            FontSize="18"
                            Style="{StaticResource MaterialDesignOutlinedTextBox}"
                            Text="{Binding PatientID, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                            <TextBox.InputBindings>
                                <KeyBinding
                                    Key="Enter"
                                    Command="{Binding SearchCommand}"
                                    CommandParameter="{Binding PatientID}" />
                            </TextBox.InputBindings>
                        </TextBox>

                        <Button
                            Grid.Column="1"
                            Height="48"
                            MinWidth="140"
                            Margin="8,5,8,5"
                            Command="{Binding SearchCommand}"
                            CommandParameter="{Binding Text, ElementName=SearchTextBox}">
                            <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                <materialDesign:PackIcon
                                    Width="20"
                                    Height="20"
                                    Margin="0,0,8,0"
                                    Kind="Search" />
                                <TextBlock FontSize="16" Text="Tra cá»©u" />
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!--  HÃ ng 2: Search Box theo Ma_bn (Sovv) + Thá»i gian - Hiá»‡n khi IsSearchByMaBn = True  -->
                    <Grid>
                        <Grid.Style>
                            <Style TargetType="Grid">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsSearchByMaBn}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Grid.Style>

                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="8" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Ma_bn (Sovv) vÃ  Button  -->
                        <Grid Grid.Row="0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <TextBox
                                x:Name="MaBnSearchTextBox"
                                Grid.Column="0"
                                MinHeight="48"
                                Margin="0,0,8,0"
                                VerticalContentAlignment="Center"
                                materialDesign:HintAssist.Hint="Nháº­p Ma_bn (Sovv - Sá»‘ vÃ o viá»‡n)"
                                materialDesign:TextFieldAssist.HasClearButton="True"
                                FontSize="18"
                                Style="{StaticResource MaterialDesignOutlinedTextBox}"
                                Text="{Binding MaBenhNhan, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter" Command="{Binding SearchByMaBnCommand}" />
                                </TextBox.InputBindings>
                            </TextBox>

                            <Button
                                Grid.Column="1"
                                Height="48"
                                MinWidth="140"
                                Margin="8,5,8,5"
                                Command="{Binding SearchByMaBnCommand}">
                                <StackPanel VerticalAlignment="Center" Orientation="Horizontal">
                                    <materialDesign:PackIcon
                                        Width="20"
                                        Height="20"
                                        Margin="0,0,8,0"
                                        Kind="Search" />
                                    <TextBlock FontSize="16" Text="Tra Cá»©u" />
                                </StackPanel>
                            </Button>
                        </Grid>

                        <!--  Date Picker  -->
                        <Grid Grid.Row="2">
                            <DatePicker
                                MinHeight="48"
                                materialDesign:HintAssist.Hint="NgÃ y vÃ o (tá»«)"
                                FontSize="16"
                                SelectedDate="{Binding NgayVaoFrom, Mode=TwoWay}"
                                Style="{StaticResource MaterialDesignOutlinedDatePicker}" />
                        </Grid>
                    </Grid>

                    <!--  HÃ ng 3: Danh sÃ¡ch MA_LK káº¿t quáº£ (chá»‰ hiá»‡n khi tÃ¬m theo MA_BN)  -->
                    <Border
                        Margin="0,12,0,0"
                        Padding="12"
                        Background="#F9FAFB"
                        BorderBrush="#E5E7EB"
                        BorderThickness="1"
                        CornerRadius="4">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Visibility" Value="Collapsed" />
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsSearchByMaBn}" Value="True">
                                        <Setter Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>

                        <StackPanel>
                            <!--  Hiá»‡n danh sÃ¡ch khi cÃ³ káº¿t quáº£  -->
                            <StackPanel Visibility="{Binding HasMaLkSearchResults, Converter={StaticResource BoolToVis}}">
                                <!--  Header vá»›i nÃºt expand/collapse  -->
                                <Grid Margin="0,0,0,12">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock
                                        Grid.Column="0"
                                        VerticalAlignment="Center"
                                        FontSize="14"
                                        FontWeight="SemiBold"
                                        Foreground="#374151">
                                        <Run Text="âœ… TÃ¬m tháº¥y " />
                                        <Run FontWeight="Bold" Text="{Binding MaLkSearchResults.Count, Mode=OneWay}" />
                                        <Run Text=" mÃ£ liÃªn káº¿t. Chá»n má»™t Ä‘á»ƒ xem chi tiáº¿t:" />
                                    </TextBlock>

                                    <!--  NÃºt toggle expand/collapse  -->
                                    <Button
                                        Grid.Column="1"
                                        Width="32"
                                        Height="32"
                                        Padding="0"
                                        Command="{Binding ToggleSearchResultsExpandCommand}"
                                        Style="{StaticResource MaterialDesignIconButton}">
                                        <materialDesign:PackIcon Width="20" Height="20">
                                            <materialDesign:PackIcon.Style>
                                                <Style TargetType="materialDesign:PackIcon">
                                                    <Setter Property="Kind" Value="ChevronUp" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsSearchResultsExpanded}" Value="False">
                                                            <Setter Property="Kind" Value="ChevronDown" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </materialDesign:PackIcon.Style>
                                        </materialDesign:PackIcon>
                                        <Button.ToolTip>
                                            <ToolTip>
                                                <TextBlock>
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Text" Value="Thu gá»n danh sÃ¡ch" />
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsSearchResultsExpanded}" Value="False">
                                                                    <Setter Property="Text" Value="Má»Ÿ rá»™ng danh sÃ¡ch" />
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </ToolTip>
                                        </Button.ToolTip>
                                    </Button>
                                </Grid>

                                <!--  ListBox vá»›i dynamic height  -->
                                <ListBox
                                    ItemsSource="{Binding MaLkSearchResults}"
                                    SelectedItem="{Binding SelectedMaLkResult, Mode=TwoWay}"
                                    SelectionMode="Single">
                                    <ListBox.Style>
                                        <Style TargetType="ListBox">
                                            <Setter Property="MaxHeight" Value="600" />
                                            <Setter Property="Visibility" Value="Visible" />
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding IsSearchResultsExpanded}" Value="False">
                                                    <Setter Property="MaxHeight" Value="0" />
                                                    <Setter Property="Visibility" Value="Collapsed" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListBox.Style>
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <Border
                                                Margin="0,4"
                                                Padding="16,12"
                                                Background="White"
                                                BorderBrush="#D1D5DB"
                                                BorderThickness="1"
                                                CornerRadius="6"
                                                Cursor="Hand">
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#F0F9FF" />
                                                                <Setter Property="BorderBrush" Value="#3B82F6" />
                                                                <Setter Property="BorderThickness" Value="2" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <Border.InputBindings>
                                                    <MouseBinding
                                                        Command="{Binding DataContext.SelectMaLkFromListCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        MouseAction="LeftClick" />
                                                </Border.InputBindings>
                                                <TextBlock
                                                    FontSize="14"
                                                    FontWeight="Medium"
                                                    Text="{Binding DisplayText}"
                                                    TextWrapping="Wrap" />
                                            </Border>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>

                            <!--  Message khi khÃ´ng cÃ³ káº¿t quáº£  -->
                            <TextBlock
                                Margin="0,4,0,0"
                                FontSize="13"
                                FontStyle="Italic"
                                Foreground="#6B7280"
                                Text="ðŸ“‹ ChÆ°a cÃ³ káº¿t quáº£ tÃ¬m kiáº¿m. Nháº­p Ma_bn (Sovv - Sá»‘ vÃ o viá»‡n) vÃ  chá»n thá»i gian, sau Ä‘Ã³ click 'tra cá»©u'."
                                TextWrapping="Wrap">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Visible" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding HasMaLkSearchResults}" Value="True">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </materialDesign:Card>

            <Border Grid.Row="1" />

            <!--  BATCH PROCESSING PROGRESS  -->
            <materialDesign:Card
                Grid.Row="1"
                Margin="0,8,0,0"
                Padding="16"
                Visibility="{Binding IsBatchProcessing, Converter={StaticResource BoolToVis}}">
                <StackPanel>
                    <TextBlock
                        Margin="0,0,0,8"
                        FontSize="16"
                        FontWeight="SemiBold"
                        Text="{Binding BatchStatus}" />
                    <ProgressBar
                        Height="8"
                        Maximum="{Binding BatchTotal}"
                        Style="{StaticResource MaterialDesignLinearProgressBar}"
                        Value="{Binding BatchProgress}" />
                    <TextBlock
                        Margin="0,4,0,0"
                        HorizontalAlignment="Right"
                        FontSize="12"
                        Foreground="{DynamicResource MaterialDesignBodyLight}"
                        TextAlignment="Right">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0} / {1}">
                                <Binding Path="BatchProgress" />
                                <Binding Path="BatchTotal" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </materialDesign:Card>

            <!--  RESULTS SECTION  -->
            <Grid Grid.Row="2">
                <!--  RESULTS SECTION with synchronized scrolling  -->
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!--  Table Header  -->
                        <materialDesign:Card Margin="0,0,0,4" Padding="12,8">
                            <materialDesign:Card.Style>
                                <Style TargetType="materialDesign:Card">
                                    <Setter Property="Visibility" Value="Visible" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding ValidationResults.Count}" Value="0">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsLoading}" Value="True">
                                            <Setter Property="Visibility" Value="Collapsed" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </materialDesign:Card.Style>

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="600" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="0"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="MÃ£ liÃªn káº¿t" />
                                <TextBlock
                                    Grid.Column="1"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="Há» vÃ  tÃªn" />
                                <TextBlock
                                    Grid.Column="2"
                                    HorizontalAlignment="Center"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="Giá»›i tÃ­nh" />
                                <TextBlock
                                    Grid.Column="3"
                                    HorizontalAlignment="Center"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="NgÃ y sinh" />
                                <TextBlock
                                    Grid.Column="4"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="Ná»™i dung lá»—i" />
                                <TextBlock
                                    Grid.Column="5"
                                    HorizontalAlignment="Center"
                                    FontWeight="Bold"
                                    Foreground="{DynamicResource PrimaryHueMidBrush}"
                                    Text="Chi tiáº¿t" />
                            </Grid>
                        </materialDesign:Card>

                        <!--  Results List  -->
                        <ItemsControl x:Name="ResultsItemsControl" ItemsSource="{Binding ValidationResults}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <materialDesign:Card Margin="0,0,0,6" Padding="0">
                                        <Border
                                            Background="Transparent"
                                            BorderBrush="#E0E0E0"
                                            BorderThickness="0,0,0,1">
                                            <Grid Margin="12,10">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="600" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!--  MÃ£ liÃªn káº¿t  -->
                                                <ContentControl Grid.Column="0">
                                                    <TextBlock
                                                        VerticalAlignment="Center"
                                                        FontWeight="Medium"
                                                        Style="{StaticResource CellTextBlock}"
                                                        Text="{Binding Ma_Lk}" />
                                                </ContentControl>

                                                <!--  Há» tÃªn  -->
                                                <ContentControl Grid.Column="1">
                                                    <TextBlock
                                                        VerticalAlignment="Center"
                                                        FontWeight="SemiBold"
                                                        Style="{StaticResource CellTextBlock}"
                                                        Text="{Binding Ho_Ten}" />
                                                </ContentControl>

                                                <!--  Giá»›i tÃ­nh  -->
                                                <ContentControl Grid.Column="2">
                                                    <Border
                                                        Padding="12,4"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Background="#E3F2FD"
                                                        CornerRadius="12">
                                                        <TextBlock
                                                            FontSize="13"
                                                            FontWeight="Medium"
                                                            Text="{Binding Gioi_Tinh}" />
                                                    </Border>
                                                </ContentControl>

                                                <!--  NgÃ y sinh  -->
                                                <ContentControl Grid.Column="3">
                                                    <TextBlock
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Style="{StaticResource CellTextBlock}"
                                                        Text="{Binding Nam_Sinh}" />
                                                </ContentControl>

                                                <!--  Ná»™i dung lá»—i  -->
                                                <ContentControl Grid.Column="4">
                                                    <Border
                                                        Padding="10,6"
                                                        Background="{Binding IsError, Converter={StaticResource ErrorContentBackgroundConverter}}"
                                                        BorderBrush="{Binding IsError, Converter={StaticResource ErrorContentBorderConverter}}"
                                                        BorderThickness="1"
                                                        CornerRadius="6">
                                                        <TextBlock
                                                            VerticalAlignment="Center"
                                                            FontSize="13"
                                                            Foreground="{Binding IsError, Converter={StaticResource ErrorContentToColorConverter}}"
                                                            Text="{Binding Noi_Dung_Loi}"
                                                            TextWrapping="Wrap"
                                                            ToolTip="{Binding Noi_Dung_Loi}" />
                                                    </Border>
                                                </ContentControl>

                                                <!--  NÃºt Ä‘á»ƒ xem chi tiáº¿t  -->
                                                <ContentControl Grid.Column="5">
                                                    <Button
                                                        Width="40"
                                                        Height="40"
                                                        Padding="0"
                                                        Background="green"
                                                        BorderBrush="#1976D2"
                                                        BorderThickness="1"
                                                        Command="{Binding DataContext.ShowErrorDetailsCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        CommandParameter="{Binding}"
                                                        ToolTip="Xem chi tiáº¿t lá»—i">
                                                        <materialDesign:PackIcon
                                                            Width="20"
                                                            Height="20"
                                                            Foreground="White"
                                                            Kind="Eye" />
                                                    </Button>
                                                </ContentControl>
                                            </Grid>

                                            <!--  Hover effect  -->
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#F5F5F5" />
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                        </Border>
                                    </materialDesign:Card>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </ScrollViewer>
                <!--  EMPTY STATE -  -->
                <ContentControl>
                    <ContentControl.Style>
                        <Style TargetType="ContentControl">
                            <Setter Property="Visibility" Value="Collapsed" />
                            <Style.Triggers>
                                <MultiDataTrigger>
                                    <MultiDataTrigger.Conditions>
                                        <Condition Binding="{Binding IsLoading}" Value="False" />
                                        <Condition Binding="{Binding ValidationResults.Count}" Value="0" />
                                    </MultiDataTrigger.Conditions>
                                    <Setter Property="Visibility" Value="Visible" />
                                </MultiDataTrigger>
                            </Style.Triggers>
                        </Style>
                    </ContentControl.Style>

                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <materialDesign:PackIcon
                            Width="64"
                            Height="64"
                            Kind="DatabaseSearch"
                            Opacity="0.4" />
                        <TextBlock
                            Margin="0,12,0,0"
                            FontSize="16"
                            Opacity="0.6"
                            Text="ChÆ°a cÃ³ dá»¯ liá»‡u" />
                        <TextBlock
                            Margin="0,4,0,0"
                            FontSize="14"
                            Opacity="0.5"
                            Text="Nháº­p sá»‘ bá»‡nh Ã¡n/sá»‘ tiáº¿p nháº­n rá»“i nháº¥n Tra cá»©u" />
                    </StackPanel>
                </ContentControl>
            </Grid>
        </Grid>

        <!--  LOADING OVERLAY  -->
        <Border Background="#E0000000" Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <control:AILoadingControl
                    StatusText="Äang xá»­ lÃ½ dá»¯ liá»‡u..."
                    SubStatusText="AI Ä‘ang phÃ¢n tÃ­ch vÃ  kiá»ƒm tra thÃ´ng tin" />
                <TextBlock
                    Margin="0,8,0,0"
                    HorizontalAlignment="Center"
                    FontSize="14"
                    Foreground="#00D4FF"
                    Text="{Binding LoadingElapsedDisplay, StringFormat='ÄÃ£ chá»: {0}'}" />
            </StackPanel>
        </Border>

        <!--  CHi tiáº¿t lá»—i  -->
        <Border
            Margin="10,-10,-10,10"
            Background="#80000000"
            Visibility="{Binding IsOverlayVisible, Converter={StaticResource BoolToVis}}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="0.05*" />
                    <RowDefinition Height="0.95*" />
                    <RowDefinition Height="0.1*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.1*" />
                    <ColumnDefinition Width="0.9*" />
                    <ColumnDefinition Width="0.1*" />
                </Grid.ColumnDefinitions>

                <materialDesign:Card
                    Grid.Row="1"
                    Grid.Column="1"
                    Padding="16">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Chá»n rule: dropdown â†’ báº£ng XML bÃªn dÆ°á»›i chá»‰ hiá»ƒn thá»‹ dÃ²ng lá»—i cá»§a rule Ä‘Ã³  -->
                        <Border
                            Grid.Row="0"
                            Margin="0,0,0,12"
                            Padding="12"
                            Background="#FFF8E1"
                            BorderBrush="#FFC107"
                            BorderThickness="0,0,0,2"
                            CornerRadius="4">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock
                                    VerticalAlignment="Center"
                                    FontSize="13"
                                    FontWeight="SemiBold"
                                    Foreground="#E65100"
                                    Margin="0,0,8,0"
                                    Text="Chá»n rule:" />
                                <ComboBox
                                    ItemsSource="{Binding OverlayErrorRules}"
                                    SelectedItem="{Binding SelectedOverlayRule, Mode=TwoWay}"
                                    DisplayMemberPath="TabHeader"
                                    MinWidth="280"
                                    VerticalAlignment="Center"
                                    materialDesign:HintAssist.Hint="Táº¥t cáº£ dÃ²ng lá»—i" />
                            </StackPanel>
                        </Border>

                        <!--  Tab Control XML1â€“XML5 (giá»¯ nguyÃªn)  -->
                        <TabControl
                            Grid.Row="1"
                            RenderOptions.BitmapScalingMode="HighQuality"
                            RenderOptions.EdgeMode="Aliased"
                            SelectedIndex="0"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling">
                        <TabItem Style="{StaticResource ColoredTabItem}">
                                <TabItem.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="XML1">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.HasOverlayXml1Error, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="True">
                                                            <Setter Property="Foreground" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </TabItem.HeaderTemplate>
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="16">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <!--  ThÃ´ng tin cÃ¡ nhÃ¢n  -->
                                        <materialDesign:Card
                                            Grid.Row="0"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,12"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Foreground="#2196F3"
                                                    Text="THÃ”NG TIN CÃ NHÃ‚N" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ liÃªn káº¿t" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Lk}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ bá»‡nh nhÃ¢n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Bn}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Sá»‘ thá»© tá»±" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Stt}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Há» vÃ  tÃªn" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            FontWeight="SemiBold"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ho_Ten}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Sá»‘ CCCD" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.So_Cccd}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y sinh" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ngay_Sinh}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Giá»›i tÃ­nh" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Gioi_Tinh, Converter={StaticResource GenderConverter}}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Quá»‘c tá»‹ch" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_QuocTich}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="DÃ¢n tá»™c" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_DanToc}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Nghá» nghiá»‡p" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Nghe_Nghiep}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Äá»‹a chá»‰" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Dia_Chi}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Äiá»‡n thoáº¡i" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Dien_Thoai}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Tá»‰nh cÆ° trÃº" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Matinh_Cu_Tru}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Huyá»‡n cÆ° trÃº" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Mahuyen_Cu_Tru}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="XÃ£ cÆ° trÃº" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Maxa_Cu_Tru}" />
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ThÃ´ng tin BHYT  -->
                                        <materialDesign:Card
                                            Grid.Row="1"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,12"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Foreground="#4CAF50"
                                                    Text="THÃ”NG TIN BHYT" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ tháº» BHYT" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_The_Bhyt}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="GiÃ¡ trá»‹ tá»«" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Gt_The_Tu}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="GiÃ¡ trá»‹ Ä‘áº¿n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Gt_The_Den}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ Ä‘Äƒng kÃ½ KCB" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Dkbd}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y miá»…n CCT" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ngay_Mien_Cct}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="LÃ½ do viá»‡n vÃ£ng" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ly_Do_Vv}" />
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ThÃ´ng tin Ä‘iá»u trá»‹  -->
                                        <materialDesign:Card
                                            Grid.Row="2"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,12"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Foreground="#FF9800"
                                                    Text="THÃ”NG TIN ÄIá»€U TRá»Š" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Cháº©n Ä‘oÃ¡n vÃ o viá»‡n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Chan_DoAn_Vao}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Cháº©n Ä‘oÃ¡n ra viá»‡n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Chan_DoAn_Rv}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ bá»‡nh chÃ­nh" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Benh_Chinh}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y vÃ o viá»‡n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ngay_Vao}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y vÃ o ná»™i trÃº" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ngay_Vao_Noi_Tru}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y ra viá»‡n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ngay_Ra}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Sá»‘ ngÃ y Ä‘iá»u trá»‹" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.So_Ngay_Dtri}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="PhÆ°Æ¡ng phÃ¡p Ä‘iá»u trá»‹" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Pp_Dieu_Tri}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Káº¿t quáº£ Ä‘iá»u trá»‹" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ket_Qua_Dtri}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ bá»‡nh kÃ¨m theo" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Benh_Kt}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ bá»‡nh YHCT" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="{Binding OverlayXml1Data.IsError, Converter={StaticResource ErrorToColorConverter}}"
                                                            Text="{Binding OverlayXml1Data.Ma_Benh_Yhct}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ pháº«u thuáº­t QT" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Pttt_Qt}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ Ä‘á»‘i tÆ°á»£ng KCB" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_DoiTuong_Kcb}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ tai náº¡n" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Tai_Nan}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ loáº¡i ra viá»‡n" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Loai_Rv}" />
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ThÃ´ng tin thanh toÃ¡n  -->
                                        <materialDesign:Card
                                            Grid.Row="3"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,12"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Foreground="#9C27B0"
                                                    Text="THÃ”NG TIN THANH TOÃN" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Tá»•ng chi phÃ­ thuá»‘c" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_Thuoc, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Tá»•ng chi phÃ­ VTYT" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_Vtyt, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Tá»•ng chi phÃ­ BV" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_TongChi_Bv, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="BHYT thanh toÃ¡n" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_TongChi_Bh, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Bá»‡nh nhÃ¢n tráº£" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_Bntt, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Nguá»“n khÃ¡c" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.T_NguonKhac, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="BHYT tráº£ trá»±c tiáº¿p" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_Bhtt, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="BHYT tráº£ GDV" />
                                                        <TextBlock
                                                            FontSize="14"
                                                            Foreground="#666"
                                                            Text="{Binding OverlayXml1Data.T_Bhtt_Gdv, StringFormat='{}{0:N0} VNÄ'}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y thanh toÃ¡n" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ngay_Ttoan}" />
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ThÃ´ng tin bá»• sung  -->
                                        <materialDesign:Card Grid.Row="4" Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,12"
                                                    FontSize="16"
                                                    FontWeight="Bold"
                                                    Foreground="#FF9800"
                                                    Text="THÃ”NG TIN Bá»” SUNG" />
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="*" />
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                        <RowDefinition Height="Auto" />
                                                    </Grid.RowDefinitions>

                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ khoa" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Khoa}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ CSKCB" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Cskcb}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ khu vá»±c" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_KhuVuc}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="CÃ¢n náº·ng" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Can_Nang}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="CÃ¢n náº·ng con" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Can_Nang_Con}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="1"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NÄƒm nam liÃªn tá»¥c" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Nam_Nam_Lien_Tuc}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NhÃ³m mÃ¡u" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Nhom_Mau}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NgÃ y tÃ¡i khÃ¡m" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ngay_Tai_Kham}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="2"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ HSBA" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Hsba}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ TTDV" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Ttdv}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Dá»± phÃ²ng" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Du_Phong}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="3"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,8">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="NÄƒm quyáº¿t toÃ¡n" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Nam_Qt}" />
                                                    </StackPanel>

                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="0"
                                                        Margin="0,0,8,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="ThÃ¡ng quyáº¿t toÃ¡n" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Thang_Qt}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="1"
                                                        Margin="4,0,4,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="MÃ£ loáº¡i KCB" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ma_Loai_Kcb}" />
                                                    </StackPanel>
                                                    <StackPanel
                                                        Grid.Row="4"
                                                        Grid.Column="2"
                                                        Margin="8,0,0,0">
                                                        <TextBlock
                                                            FontWeight="Bold"
                                                            Foreground="#666"
                                                            Text="Ghi chÃº" />
                                                        <TextBlock FontSize="14" Text="{Binding OverlayXml1Data.Ghi_Chu}" />
                                                    </StackPanel>
                                                </Grid>
                                            </StackPanel>
                                        </materialDesign:Card>
                                    </Grid>
                                </ScrollViewer>
                            </TabItem>

                            <TabItem
                                Style="{StaticResource ColoredTabItem}"
                                Visibility="{Binding DataContext.HasOverlayXml2Error, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BoolToVis}}">
                                <TabItem.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="XML2">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.HasOverlayXml2Error, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="True">
                                                            <Setter Property="Foreground" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </TabItem.HeaderTemplate>
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="16">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <!--  Header  -->
                                        <materialDesign:Card
                                            Grid.Row="0"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,8"
                                                    FontSize="18"
                                                    FontWeight="Bold"
                                                    Foreground="#1976D2"
                                                    Text="DANH SÃCH THUá»C Sá»¬ Dá»¤NG" />
                                                <TextBlock
                                                    FontSize="14"
                                                    Foreground="#666"
                                                    Text="ThÃ´ng tin chi tiáº¿t vá» cÃ¡c loáº¡i thuá»‘c bá»‡nh nhÃ¢n Ä‘Ã£ sá»­ dá»¥ng trong quÃ¡ trÃ¬nh Ä‘iá»u trá»‹" />
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ItemsControl vá»›i Virtualization - Hiá»‡u suáº¥t tá»‘i Æ°u  -->
                                        <materialDesign:Card Grid.Row="1" Padding="16">
                                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl
                                                    ItemsSource="{Binding FilteredOverlayXml2Data}"
                                                    VirtualizingPanel.CacheLength="5,5"
                                                    VirtualizingPanel.CacheLengthUnit="Page"
                                                    VirtualizingPanel.IsVirtualizing="True"
                                                    VirtualizingPanel.VirtualizationMode="Recycling">
                                                    <!--  Header Template  -->
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <VirtualizingStackPanel Orientation="Vertical" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>

                                                    <!--  Header Row  -->
                                                    <ItemsControl.Template>
                                                        <ControlTemplate TargetType="ItemsControl">
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="*" />
                                                                </Grid.RowDefinitions>

                                                                <!--  Header  -->
                                                                <Border
                                                                    Grid.Row="0"
                                                                    Padding="8,6"
                                                                    Background="#F5F5F5"
                                                                    BorderBrush="#DDD"
                                                                    BorderThickness="0,0,0,1">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="200" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock
                                                                            Grid.Column="0"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="STT" />
                                                                        <TextBlock
                                                                            Grid.Column="1"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ thuá»‘c" />
                                                                        <TextBlock
                                                                            Grid.Column="2"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ PP cháº¿ biáº¿n" />
                                                                        <TextBlock
                                                                            Grid.Column="3"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ CSKCB thuá»‘c" />
                                                                        <TextBlock
                                                                            Grid.Column="4"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ nhÃ³m" />
                                                                        <TextBlock
                                                                            Grid.Column="5"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="TÃªn thuá»‘c" />
                                                                        <TextBlock
                                                                            Grid.Column="6"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n vá»‹ tÃ­nh" />
                                                                        <TextBlock
                                                                            Grid.Column="7"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="HÃ m lÆ°á»£ng" />
                                                                        <TextBlock
                                                                            Grid.Column="8"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ°á»ng dÃ¹ng" />
                                                                        <TextBlock
                                                                            Grid.Column="9"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Dáº¡ng bÃ o cháº¿" />
                                                                        <TextBlock
                                                                            Grid.Column="10"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Liá»u dÃ¹ng" />
                                                                        <TextBlock
                                                                            Grid.Column="11"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="CÃ¡ch dÃ¹ng" />
                                                                        <TextBlock
                                                                            Grid.Column="12"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Sá»‘ Ä‘Äƒng kÃ½" />
                                                                        <TextBlock
                                                                            Grid.Column="13"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="TT tháº§u" />
                                                                        <TextBlock
                                                                            Grid.Column="14"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Pháº¡m vi" />
                                                                        <TextBlock
                                                                            Grid.Column="15"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Tá»· lá»‡ TT BH" />
                                                                        <TextBlock
                                                                            Grid.Column="16"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Sá»‘ lÆ°á»£ng" />
                                                                        <TextBlock
                                                                            Grid.Column="17"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n giÃ¡" />
                                                                        <TextBlock
                                                                            Grid.Column="18"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ThÃ nh tiá»n BV" />
                                                                        <TextBlock
                                                                            Grid.Column="19"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ThÃ nh tiá»n BH" />
                                                                        <TextBlock
                                                                            Grid.Column="20"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T Nguá»“n khÃ¡c NSNN" />
                                                                        <TextBlock
                                                                            Grid.Column="21"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T Nguá»“n khÃ¡c VTNN" />
                                                                        <TextBlock
                                                                            Grid.Column="22"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T Nguá»“n khÃ¡c VTTN" />
                                                                        <TextBlock
                                                                            Grid.Column="23"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T Nguá»“n khÃ¡c CL" />
                                                                        <TextBlock
                                                                            Grid.Column="24"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T Nguá»“n khÃ¡c" />
                                                                        <TextBlock
                                                                            Grid.Column="25"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Má»©c hÆ°á»Ÿng" />
                                                                        <TextBlock
                                                                            Grid.Column="26"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T BNTT" />
                                                                        <TextBlock
                                                                            Grid.Column="27"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T BNCCT" />
                                                                        <TextBlock
                                                                            Grid.Column="28"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="T BHTT" />
                                                                        <TextBlock
                                                                            Grid.Column="29"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ khoa" />
                                                                        <TextBlock
                                                                            Grid.Column="30"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ bÃ¡c sÄ©" />
                                                                        <TextBlock
                                                                            Grid.Column="31"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ dá»‹ch vá»¥" />
                                                                        <TextBlock
                                                                            Grid.Column="32"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y YL" />
                                                                        <TextBlock
                                                                            Grid.Column="33"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ PTTT" />
                                                                        <TextBlock
                                                                            Grid.Column="34"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Nguá»“n CTRA" />
                                                                        <TextBlock
                                                                            Grid.Column="35"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Váº¿t thÆ°Æ¡ng TP" />
                                                                        <TextBlock
                                                                            Grid.Column="36"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Dá»± phÃ²ng" />
                                                                        <TextBlock
                                                                            Grid.Column="37"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y th YL" />
                                                                    </Grid>
                                                                </Border>

                                                                <!--  Items  -->
                                                                <ItemsPresenter Grid.Row="1" />
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </ItemsControl.Template>

                                                    <!--  Item Template  -->
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border
                                                                Background="Transparent"
                                                                BorderBrush="#E0E0E0"
                                                                BorderThickness="0,0,0,1">
                                                                <Border.Style>
                                                                    <Style TargetType="Border">
                                                                        <Setter Property="Background">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource ErrorRowConverter}">
                                                                                    <Binding Path="Id" />
                                                                                    <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#F0F8FF" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>

                                                                <Grid Margin="8,4">
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="200" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock
                                                                        Grid.Column="0"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Stt}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="1"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Thuoc}"
                                                                        TextTrimming="CharacterEllipsis">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="2"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Pp_CheBien}"
                                                                        TextTrimming="CharacterEllipsis">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="3"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Cskcb_Thuoc}"
                                                                        TextTrimming="CharacterEllipsis">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="4"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Nhom}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="5"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ten_Thuoc}"
                                                                        TextTrimming="CharacterEllipsis">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="6"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Don_Vi_Tinh}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="7"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ham_Luong}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="8"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Duong_Dung}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="9"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Dang_Bao_Che}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="10"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Lieu_Dung}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="11"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Cach_Dung}">
                                                                        <TextBlock.Foreground>
                                                                            <MultiBinding Converter="{StaticResource ErrorTextConverter}">
                                                                                <Binding Path="Id" />
                                                                                <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                            </MultiBinding>
                                                                        </TextBlock.Foreground>
                                                                    </TextBlock>
                                                                    <TextBlock
                                                                        Grid.Column="12"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding So_Dang_Ky}" />
                                                                    <TextBlock
                                                                        Grid.Column="13"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Tt_Thau}" />
                                                                    <TextBlock
                                                                        Grid.Column="14"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Pham_Vi}" />
                                                                    <TextBlock
                                                                        Grid.Column="15"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Tyle_Tt_Bh, StringFormat='{}{0:P0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="16"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding So_Luong, StringFormat='{}{0:N0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="17"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Don_Gia, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="18"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Thanh_Tien_Bv, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="19"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Thanh_Tien_Bh, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="20"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_NguonKhac_Nsnn, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="21"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_NguonKhac_Vtnn, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="22"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_NguonKhac_Vttn, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="23"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_NguonKhac_Cl, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="24"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_NguonKhac, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="25"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Muc_Huong, StringFormat='{}{0:P0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="26"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_Bntt, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="27"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_Bncct, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="28"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_Bhtt, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="29"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Khoa}" />
                                                                    <TextBlock
                                                                        Grid.Column="30"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Bac_Si}" />
                                                                    <TextBlock
                                                                        Grid.Column="31"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Dich_Vu}" />
                                                                    <TextBlock
                                                                        Grid.Column="32"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Yl}" />
                                                                    <TextBlock
                                                                        Grid.Column="33"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Pttt}" />
                                                                    <TextBlock
                                                                        Grid.Column="34"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Nguon_Ctra}" />
                                                                    <TextBlock
                                                                        Grid.Column="35"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Vet_Thuong_Tp}" />
                                                                    <TextBlock
                                                                        Grid.Column="36"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Du_Phong}" />
                                                                    <TextBlock
                                                                        Grid.Column="37"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Th_Yl}" />
                                                                </Grid>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </materialDesign:Card>
                                    </Grid>
                                </ScrollViewer>
                            </TabItem>

                            <TabItem
                                Style="{StaticResource ColoredTabItem}"
                                Visibility="{Binding DataContext.HasOverlayXml3Error, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BoolToVis}}">
                                <TabItem.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="XML3">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.HasOverlayXml3Error, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="True">
                                                            <Setter Property="Foreground" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </TabItem.HeaderTemplate>
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="16">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <!--  Header  -->
                                        <materialDesign:Card
                                            Grid.Row="0"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,8"
                                                    FontSize="18"
                                                    FontWeight="Bold"
                                                    Foreground="#1976D2"
                                                    Text="DANH SÃCH Váº¬T TÆ¯ Y Táº¾" />
                                                <TextBlock
                                                    FontSize="14"
                                                    Foreground="#666"
                                                    Text="ThÃ´ng tin chi tiáº¿t vá» cÃ¡c váº­t tÆ° y táº¿, thiáº¿t bá»‹ vÃ  dá»‹ch vá»¥ ká»¹ thuáº­t Ä‘Ã£ sá»­ dá»¥ng" />
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ItemsControl vá»›i Virtualization - Hiá»‡u suáº¥t tá»‘i Æ°u  -->
                                        <materialDesign:Card Grid.Row="1" Padding="16">
                                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl
                                                    ItemsSource="{Binding FilteredOverlayXml3Data}"
                                                    VirtualizingPanel.CacheLength="5,5"
                                                    VirtualizingPanel.CacheLengthUnit="Page"
                                                    VirtualizingPanel.IsVirtualizing="True"
                                                    VirtualizingPanel.VirtualizationMode="Recycling">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <VirtualizingStackPanel Orientation="Vertical" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>

                                                    <!--  Header Row  -->
                                                    <ItemsControl.Template>
                                                        <ControlTemplate TargetType="ItemsControl">
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="*" />
                                                                </Grid.RowDefinitions>

                                                                <!--  Header  -->
                                                                <Border
                                                                    Grid.Row="0"
                                                                    Padding="8,6"
                                                                    Background="#F5F5F5"
                                                                    BorderBrush="#DDD"
                                                                    BorderThickness="0,0,0,1">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="50" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="200" />
                                                                            <ColumnDefinition Width="200" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="80" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock
                                                                            Grid.Column="0"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="STT" />
                                                                        <TextBlock
                                                                            Grid.Column="1"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ dá»‹ch vá»¥" />
                                                                        <TextBlock
                                                                            Grid.Column="2"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ váº­t tÆ°" />
                                                                        <TextBlock
                                                                            Grid.Column="3"
                                                                            FontWeight="Bold"
                                                                            Text="TÃªn váº­t tÆ°" />
                                                                        <TextBlock
                                                                            Grid.Column="4"
                                                                            FontWeight="Bold"
                                                                            Text="TÃªn dá»‹ch vá»¥" />
                                                                        <TextBlock
                                                                            Grid.Column="5"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n vá»‹ tÃ­nh" />
                                                                        <TextBlock
                                                                            Grid.Column="6"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Sá»‘ lÆ°á»£ng" />
                                                                        <TextBlock
                                                                            Grid.Column="7"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n giÃ¡ BV" />
                                                                        <TextBlock
                                                                            Grid.Column="8"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n giÃ¡ BH" />
                                                                        <TextBlock
                                                                            Grid.Column="9"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ThÃ nh tiá»n BV" />
                                                                        <TextBlock
                                                                            Grid.Column="10"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="ThÃ nh tiá»n BH" />
                                                                        <TextBlock
                                                                            Grid.Column="11"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Tá»· lá»‡ TT DV" />
                                                                        <TextBlock
                                                                            Grid.Column="12"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Tá»· lá»‡ TT BH" />
                                                                        <TextBlock
                                                                            Grid.Column="13"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Má»©c hÆ°á»Ÿng" />
                                                                        <TextBlock
                                                                            Grid.Column="14"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="Bá»‡nh nhÃ¢n tráº£" />
                                                                        <TextBlock
                                                                            Grid.Column="15"
                                                                            HorizontalAlignment="Right"
                                                                            FontWeight="Bold"
                                                                            Text="BHYT tráº£" />
                                                                        <TextBlock
                                                                            Grid.Column="16"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ khoa" />
                                                                        <TextBlock
                                                                            Grid.Column="17"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ giÆ°á»ng" />
                                                                        <TextBlock
                                                                            Grid.Column="18"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ bÃ¡c sÄ©" />
                                                                        <TextBlock
                                                                            Grid.Column="19"
                                                                            FontWeight="Bold"
                                                                            Text="NgÆ°á»i thá»±c hiá»‡n" />
                                                                        <TextBlock
                                                                            Grid.Column="20"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y YL" />
                                                                        <TextBlock
                                                                            Grid.Column="21"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y thá»±c hiá»‡n" />
                                                                        <TextBlock
                                                                            Grid.Column="22"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y káº¿t quáº£" />
                                                                    </Grid>
                                                                </Border>

                                                                <!--  Items  -->
                                                                <ItemsPresenter Grid.Row="1" />
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </ItemsControl.Template>

                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border
                                                                Margin="8,4"
                                                                Background="Transparent"
                                                                BorderBrush="#E0E0E0"
                                                                BorderThickness="0,0,0,1">
                                                                <Border.Style>
                                                                    <Style TargetType="Border">
                                                                        <Setter Property="Background">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource ErrorRowConverter}">
                                                                                    <Binding Path="Id" />
                                                                                    <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#F0F8FF" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>

                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="50" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="200" />
                                                                        <ColumnDefinition Width="200" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="80" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock
                                                                        Grid.Column="0"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Stt}" />
                                                                    <TextBlock
                                                                        Grid.Column="1"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Dich_Vu}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="2"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Vat_Tu}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="3"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ten_Vat_Tu}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="4"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ten_Dich_Vu}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="5"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Don_Vi_Tinh}" />
                                                                    <TextBlock
                                                                        Grid.Column="6"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding So_Luong, StringFormat='{}{0:N0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="7"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Don_Gia_Bv, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="8"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Don_Gia_Bh, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="9"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Thanh_Tien_Bv, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="10"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Thanh_Tien_Bh, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="11"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Tyle_Tt_Dv, StringFormat='{}{0:P0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="12"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Tyle_Tt_Bh, StringFormat='{}{0:P0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="13"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Muc_Huong, StringFormat='{}{0:P0}'}" />
                                                                    <TextBlock
                                                                        Grid.Column="14"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_Bntt, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="15"
                                                                        HorizontalAlignment="Right"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding T_Bhtt, StringFormat='{}{0:N0} VNÄ'}" />
                                                                    <TextBlock
                                                                        Grid.Column="16"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Khoa}" />
                                                                    <TextBlock
                                                                        Grid.Column="17"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Giuong}" />
                                                                    <TextBlock
                                                                        Grid.Column="18"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Bac_Si}" />
                                                                    <TextBlock
                                                                        Grid.Column="19"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Nguoi_Thuc_Hien}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="20"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Yl}" />
                                                                    <TextBlock
                                                                        Grid.Column="21"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Th_Yl}" />
                                                                    <TextBlock
                                                                        Grid.Column="22"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Kq}" />
                                                                </Grid>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </materialDesign:Card>
                                    </Grid>
                                </ScrollViewer>
                            </TabItem>

                            <TabItem
                                Style="{StaticResource ColoredTabItem}"
                                Visibility="{Binding DataContext.HasOverlayXml4Error, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BoolToVis}}">
                                <TabItem.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="XML4">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.HasOverlayXml4Error, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="True">
                                                            <Setter Property="Foreground" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </TabItem.HeaderTemplate>
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="16">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <!--  Header  -->
                                        <materialDesign:Card
                                            Grid.Row="0"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,8"
                                                    FontSize="18"
                                                    FontWeight="Bold"
                                                    Foreground="#1976D2"
                                                    Text="DANH SÃCH XÃ‰T NGHIá»†M" />
                                                <TextBlock
                                                    FontSize="14"
                                                    Foreground="#666"
                                                    Text="ThÃ´ng tin chi tiáº¿t vá» cÃ¡c xÃ©t nghiá»‡m, cáº­n lÃ¢m sÃ ng Ä‘Ã£ thá»±c hiá»‡n" />
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ItemsControl vá»›i Virtualization - Hiá»‡u suáº¥t tá»‘i Æ°u  -->
                                        <materialDesign:Card Grid.Row="1" Padding="16">
                                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl
                                                    ItemsSource="{Binding FilteredOverlayXml4Data}"
                                                    VirtualizingPanel.CacheLength="5,5"
                                                    VirtualizingPanel.CacheLengthUnit="Page"
                                                    VirtualizingPanel.IsVirtualizing="True"
                                                    VirtualizingPanel.VirtualizationMode="Recycling">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <VirtualizingStackPanel Orientation="Vertical" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>

                                                    <!--  Header Row  -->
                                                    <ItemsControl.Template>
                                                        <ControlTemplate TargetType="ItemsControl">
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="*" />
                                                                </Grid.RowDefinitions>

                                                                <!--  Header  -->
                                                                <Border
                                                                    Grid.Row="0"
                                                                    Padding="8,6"
                                                                    Background="#F5F5F5"
                                                                    BorderBrush="#DDD"
                                                                    BorderThickness="0,0,0,1">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="50" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="200" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="100" />
                                                                            <ColumnDefinition Width="200" />
                                                                            <ColumnDefinition Width="150" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="120" />
                                                                            <ColumnDefinition Width="100" />
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock
                                                                            Grid.Column="0"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="STT" />
                                                                        <TextBlock
                                                                            Grid.Column="1"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ dá»‹ch vá»¥" />
                                                                        <TextBlock
                                                                            Grid.Column="2"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ chá»‰ sá»‘" />
                                                                        <TextBlock
                                                                            Grid.Column="3"
                                                                            FontWeight="Bold"
                                                                            Text="TÃªn chá»‰ sá»‘" />
                                                                        <TextBlock
                                                                            Grid.Column="4"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="GiÃ¡ trá»‹" />
                                                                        <TextBlock
                                                                            Grid.Column="5"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="ÄÆ¡n vá»‹ Ä‘o" />
                                                                        <TextBlock
                                                                            Grid.Column="6"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ´ táº£" />
                                                                        <TextBlock
                                                                            Grid.Column="7"
                                                                            FontWeight="Bold"
                                                                            Text="Káº¿t luáº­n" />
                                                                        <TextBlock
                                                                            Grid.Column="8"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="NgÃ y káº¿t quáº£" />
                                                                        <TextBlock
                                                                            Grid.Column="9"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="MÃ£ BS Ä‘á»c KQ" />
                                                                        <TextBlock
                                                                            Grid.Column="10"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Dá»± phÃ²ng" />
                                                                    </Grid>
                                                                </Border>

                                                                <!--  Items  -->
                                                                <ItemsPresenter Grid.Row="1" />
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </ItemsControl.Template>

                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border
                                                                Margin="8,4"
                                                                Background="Transparent"
                                                                BorderBrush="#E0E0E0"
                                                                BorderThickness="0,0,0,1">
                                                                <Border.Style>
                                                                    <Style TargetType="Border">
                                                                        <Setter Property="Background">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource ErrorRowConverter}">
                                                                                    <Binding Path="Id" />
                                                                                    <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#F0F8FF" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>

                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="50" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="200" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="100" />
                                                                        <ColumnDefinition Width="200" />
                                                                        <ColumnDefinition Width="150" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="120" />
                                                                        <ColumnDefinition Width="100" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock
                                                                        Grid.Column="0"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Stt}" />
                                                                    <TextBlock
                                                                        Grid.Column="1"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ma_Dich_Vu}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="2"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Chi_So}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="3"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ten_Chi_So}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="4"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Gia_Tri}" />
                                                                    <TextBlock
                                                                        Grid.Column="5"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Don_Vi_Do}" />
                                                                    <TextBlock
                                                                        Grid.Column="6"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Mo_Ta}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="7"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ket_Luan}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="8"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Ngay_Kq}" />
                                                                    <TextBlock
                                                                        Grid.Column="9"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Ma_Bs_Doc_Kq}" />
                                                                    <TextBlock
                                                                        Grid.Column="10"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Du_Phong}" />
                                                                </Grid>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </materialDesign:Card>
                                    </Grid>
                                </ScrollViewer>
                            </TabItem>

                            <TabItem
                                Style="{StaticResource ColoredTabItem}"
                                Visibility="{Binding DataContext.HasOverlayXml5Error, RelativeSource={RelativeSource AncestorType=UserControl}, Converter={StaticResource BoolToVis}}">
                                <TabItem.HeaderTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="XML5">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="Black" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding DataContext.HasOverlayXml5Error, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="True">
                                                            <Setter Property="Foreground" Value="Red" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </DataTemplate>
                                </TabItem.HeaderTemplate>
                                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                    <Grid Margin="16">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="*" />
                                        </Grid.RowDefinitions>

                                        <!--  Header  -->
                                        <materialDesign:Card
                                            Grid.Row="0"
                                            Margin="0,0,0,16"
                                            Padding="16">
                                            <StackPanel>
                                                <TextBlock
                                                    Margin="0,0,0,8"
                                                    FontSize="18"
                                                    FontWeight="Bold"
                                                    Foreground="#1976D2"
                                                    Text="DANH SÃCH DIá»„N BIáº¾N LÃ‚M SÃ€NG" />
                                                <TextBlock
                                                    FontSize="14"
                                                    Foreground="#666"
                                                    Text="ThÃ´ng tin chi tiáº¿t vá» diá»…n biáº¿n lÃ¢m sÃ ng, há»™i cháº©n vÃ  cÃ¡c ghi chÃº trong quÃ¡ trÃ¬nh Ä‘iá»u trá»‹" />
                                            </StackPanel>
                                        </materialDesign:Card>

                                        <!--  ItemsControl vá»›i Virtualization - Hiá»‡u suáº¥t tá»‘i Æ°u  -->
                                        <materialDesign:Card Grid.Row="1" Padding="16">
                                            <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl
                                                    ItemsSource="{Binding FilteredOverlayXml5Data}"
                                                    VirtualizingPanel.CacheLength="5,5"
                                                    VirtualizingPanel.CacheLengthUnit="Page"
                                                    VirtualizingPanel.IsVirtualizing="True"
                                                    VirtualizingPanel.VirtualizationMode="Recycling">
                                                    <ItemsControl.ItemsPanel>
                                                        <ItemsPanelTemplate>
                                                            <VirtualizingStackPanel Orientation="Vertical" />
                                                        </ItemsPanelTemplate>
                                                    </ItemsControl.ItemsPanel>

                                                    <!--  Header Row  -->
                                                    <ItemsControl.Template>
                                                        <ControlTemplate TargetType="ItemsControl">
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto" />
                                                                    <RowDefinition Height="*" />
                                                                </Grid.RowDefinitions>

                                                                <!--  Header  -->
                                                                <Border
                                                                    Grid.Row="0"
                                                                    Padding="8,6"
                                                                    Background="#F5F5F5"
                                                                    BorderBrush="#DDD"
                                                                    BorderThickness="0,0,0,1">
                                                                    <Grid>
                                                                        <Grid.ColumnDefinitions>
                                                                            <ColumnDefinition Width="50" />
                                                                            <ColumnDefinition Width="300" />
                                                                            <ColumnDefinition Width="150" />
                                                                            <ColumnDefinition Width="300" />
                                                                            <ColumnDefinition Width="150" />
                                                                            <ColumnDefinition Width="150" />
                                                                            <ColumnDefinition Width="150" />
                                                                            <ColumnDefinition Width="200" />
                                                                        </Grid.ColumnDefinitions>

                                                                        <TextBlock
                                                                            Grid.Column="0"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="STT" />
                                                                        <TextBlock
                                                                            Grid.Column="1"
                                                                            FontWeight="Bold"
                                                                            Text="Diá»…n biáº¿n lÃ¢m sÃ ng" />
                                                                        <TextBlock
                                                                            Grid.Column="2"
                                                                            FontWeight="Bold"
                                                                            Text="Giai Ä‘oáº¡n bá»‡nh" />
                                                                        <TextBlock
                                                                            Grid.Column="3"
                                                                            FontWeight="Bold"
                                                                            Text="Há»™i cháº©n" />
                                                                        <TextBlock
                                                                            Grid.Column="4"
                                                                            FontWeight="Bold"
                                                                            Text="Pháº«u thuáº­t" />
                                                                        <TextBlock
                                                                            Grid.Column="5"
                                                                            HorizontalAlignment="Center"
                                                                            FontWeight="Bold"
                                                                            Text="Thá»i Ä‘iá»ƒm diá»…n biáº¿n" />
                                                                        <TextBlock
                                                                            Grid.Column="6"
                                                                            FontWeight="Bold"
                                                                            Text="NgÆ°á»i thá»±c hiá»‡n" />
                                                                        <TextBlock
                                                                            Grid.Column="7"
                                                                            FontWeight="Bold"
                                                                            Text="Dá»± phÃ²ng" />
                                                                    </Grid>
                                                                </Border>

                                                                <!--  Items  -->
                                                                <ItemsPresenter Grid.Row="1" />
                                                            </Grid>
                                                        </ControlTemplate>
                                                    </ItemsControl.Template>

                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border
                                                                Margin="8,4"
                                                                Background="Transparent"
                                                                BorderBrush="#E0E0E0"
                                                                BorderThickness="0,0,0,1">
                                                                <Border.Style>
                                                                    <Style TargetType="Border">
                                                                        <Setter Property="Background">
                                                                            <Setter.Value>
                                                                                <MultiBinding Converter="{StaticResource ErrorRowConverter}">
                                                                                    <Binding Path="Id" />
                                                                                    <Binding Path="DataContext.OverlayErrorIds" RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                                                                </MultiBinding>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                        <Style.Triggers>
                                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                                <Setter Property="Background" Value="#F0F8FF" />
                                                                            </Trigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Border.Style>

                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="50" />
                                                                        <ColumnDefinition Width="300" />
                                                                        <ColumnDefinition Width="150" />
                                                                        <ColumnDefinition Width="300" />
                                                                        <ColumnDefinition Width="150" />
                                                                        <ColumnDefinition Width="150" />
                                                                        <ColumnDefinition Width="150" />
                                                                        <ColumnDefinition Width="200" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <TextBlock
                                                                        Grid.Column="0"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Stt}" />
                                                                    <TextBlock
                                                                        Grid.Column="1"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Dien_Bien_Ls}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="2"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Giai_DoAn_Benh}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="3"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Hoi_Chan}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="4"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Phau_Thuat}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="5"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Thoi_Diem_Dbls}" />
                                                                    <TextBlock
                                                                        Grid.Column="6"
                                                                        VerticalAlignment="Center"
                                                                        Style="{StaticResource ErrorTextBlockStyle}"
                                                                        Text="{Binding Nguoi_Thuc_Hien}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                    <TextBlock
                                                                        Grid.Column="7"
                                                                        VerticalAlignment="Center"
                                                                        Text="{Binding Du_Phong}"
                                                                        TextTrimming="CharacterEllipsis" />
                                                                </Grid>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </materialDesign:Card>
                                    </Grid>
                                </ScrollViewer>
                            </TabItem>
                        </TabControl>


                        <!--  NÃºt Ä‘Ã³ng  -->
                        <Button
                            Grid.Row="2"
                            Width="100"
                            Height="36"
                            HorizontalAlignment="Right"
                            Command="{Binding CloseOverlayCommand}"
                            Content="ÄÃ³ng" />
                    </Grid>
                </materialDesign:Card>
            </Grid>
        </Border>

        <!--  BATCH PROCESSING LOADING OVERLAY  -->
        <Border Background="#E0000000" Visibility="{Binding IsBatchProcessing, Converter={StaticResource BoolToVis}}">
            <Grid>
                <Border
                    Width="550"
                    Padding="28"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Background="#1a1a2e"
                    BorderBrush="#00D4FF"
                    BorderThickness="2"
                    CornerRadius="20">
                    <Border.Effect>
                        <DropShadowEffect
                            BlurRadius="40"
                            Color="#00D4FF"
                            Opacity="0.6"
                            ShadowDepth="0" />
                    </Border.Effect>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="20" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="12" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="24" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <!--  Title with AI theme  -->
                        <StackPanel Grid.Row="0" HorizontalAlignment="Center" Orientation="Horizontal">
                            <TextBlock
                                FontSize="22"
                                FontWeight="Bold"
                                Foreground="#00D4FF">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Color="#00D4FF"
                                        Opacity="0.8"
                                        ShadowDepth="0" />
                                </TextBlock.Effect>
                                <Run Text="ðŸ¤– " />
                                <Run Text="AI Ä‘ang xá»­ lÃ½ dá»¯ liá»‡u Excel" />
                            </TextBlock>
                        </StackPanel>

                        <!--  Progress Info  -->
                        <StackPanel
                            Grid.Row="2"
                            HorizontalAlignment="Center"
                            Orientation="Horizontal">
                            <TextBlock Foreground="#B0B0B0" Text="ÄÃ£ xá»­ lÃ½: " />
                            <TextBlock
                                FontWeight="Bold"
                                Foreground="#00D4FF"
                                Text="{Binding BatchProgress}">
                                <TextBlock.Effect>
                                    <DropShadowEffect
                                        BlurRadius="8"
                                        Color="#00D4FF"
                                        Opacity="0.6"
                                        ShadowDepth="0" />
                                </TextBlock.Effect>
                            </TextBlock>
                            <TextBlock Foreground="#B0B0B0" Text=" / " />
                            <TextBlock
                                FontWeight="Bold"
                                Foreground="#FFFFFF"
                                Text="{Binding BatchTotal}" />
                            <TextBlock Foreground="#B0B0B0" Text=" bá»‡nh nhÃ¢n" />
                        </StackPanel>

                        <!--  Progress Bar with AI theme  -->
                        <Grid Grid.Row="4">
                            <Border
                                Height="20"
                                Background="#0f3460"
                                CornerRadius="10"
                                BorderBrush="#00D4FF"
                                BorderThickness="2">
                                <Border.Effect>
                                    <DropShadowEffect
                                        BlurRadius="15"
                                        Color="#00D4FF"
                                        Opacity="0.6"
                                        ShadowDepth="0" />
                                </Border.Effect>
                                <Grid>
                                    <ProgressBar
                                        Height="16"
                                        Margin="2"
                                        Background="Transparent"
                                        Maximum="{Binding BatchTotal}"
                                        Value="{Binding BatchProgress}">
                                        <ProgressBar.Foreground>
                                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                                <GradientStop Color="#00D4FF" Offset="0" />
                                                <GradientStop Color="#06FFA5" Offset="0.5" />
                                                <GradientStop Color="#7B2CBF" Offset="1" />
                                            </LinearGradientBrush>
                                        </ProgressBar.Foreground>
                                        <ProgressBar.Style>
                                            <Style TargetType="ProgressBar">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="ProgressBar">
                                                            <Border
                                                                Background="{TemplateBinding Background}"
                                                                CornerRadius="8"
                                                                BorderThickness="0">
                                                                <Grid x:Name="PART_Track">
                                                                    <Rectangle
                                                                        x:Name="PART_Indicator"
                                                                        Fill="{TemplateBinding Foreground}"
                                                                        RadiusX="8"
                                                                        RadiusY="8"
                                                                        HorizontalAlignment="Left">
                                                                        <Rectangle.Effect>
                                                                            <DropShadowEffect
                                                                                BlurRadius="12"
                                                                                Color="#00D4FF"
                                                                                Opacity="0.9"
                                                                                ShadowDepth="0" />
                                                                        </Rectangle.Effect>
                                                                    </Rectangle>
                                                                </Grid>
                                                            </Border>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </ProgressBar.Style>
                                    </ProgressBar>
                                    <!--  Progress Percentage  -->
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        FontSize="12"
                                        FontWeight="Bold"
                                        Foreground="#FFFFFF"
                                        Text="{Binding BatchProgressPercentage, StringFormat={}{0:F1}%}">
                                        <TextBlock.Effect>
                                            <DropShadowEffect
                                                BlurRadius="6"
                                                Color="#000000"
                                                Opacity="0.9"
                                                ShadowDepth="1" />
                                        </TextBlock.Effect>
                                    </TextBlock>
                                </Grid>
                            </Border>
                        </Grid>

                        <!--  Status Text  -->
                        <TextBlock
                            Grid.Row="6"
                            HorizontalAlignment="Center"
                            FontSize="14"
                            Foreground="#06FFA5"
                            Text="{Binding BatchStatus}"
                            TextAlignment="Center"
                            TextWrapping="Wrap">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="8"
                                    Color="#06FFA5"
                                    Opacity="0.5"
                                    ShadowDepth="0" />
                            </TextBlock.Effect>
                        </TextBlock>

                        <!--  Current Patient  -->
                        <TextBlock
                            Grid.Row="8"
                            HorizontalAlignment="Center"
                            FontSize="12"
                            Foreground="#7B2CBF"
                            Text="{Binding CurrentProcessingPatient, StringFormat='âš¡ Äang xá»­ lÃ½: {0}'}"
                            TextAlignment="Center"
                            TextWrapping="Wrap"
                            Visibility="{Binding CurrentProcessingPatient, Converter={StaticResource StringToVis}}">
                            <TextBlock.Effect>
                                <DropShadowEffect
                                    BlurRadius="6"
                                    Color="#7B2CBF"
                                    Opacity="0.5"
                                    ShadowDepth="0" />
                            </TextBlock.Effect>
                        </TextBlock>

                        <!--  Statistics  -->
                        <Grid Grid.Row="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!--  Success Count  -->
                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                <TextBlock
                                    FontSize="18"
                                    FontWeight="Bold"
                                    Foreground="#06FFA5"
                                    Text="{Binding BatchSuccessCount}">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="10"
                                            Color="#06FFA5"
                                            Opacity="0.6"
                                            ShadowDepth="0" />
                                    </TextBlock.Effect>
                                </TextBlock>
                                <TextBlock
                                    FontSize="12"
                                    Foreground="#B0B0B0"
                                    Text="âœ“ ThÃ nh cÃ´ng" />
                            </StackPanel>

                            <!--  Error Count  -->
                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                <TextBlock
                                    FontSize="18"
                                    FontWeight="Bold"
                                    Foreground="#FF6B9D"
                                    Text="{Binding BatchErrorCount}">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="10"
                                            Color="#FF6B9D"
                                            Opacity="0.6"
                                            ShadowDepth="0" />
                                    </TextBlock.Effect>
                                </TextBlock>
                                <TextBlock
                                    FontSize="12"
                                    Foreground="#B0B0B0"
                                    Text="âœ— Lá»—i" />
                            </StackPanel>

                            <!--  Speed  -->
                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                <TextBlock
                                    FontSize="18"
                                    FontWeight="Bold"
                                    Foreground="#00D4FF"
                                    Text="{Binding BatchProcessingSpeed, StringFormat={}{0:F1}}">
                                    <TextBlock.Effect>
                                        <DropShadowEffect
                                            BlurRadius="10"
                                            Color="#00D4FF"
                                            Opacity="0.6"
                                            ShadowDepth="0" />
                                    </TextBlock.Effect>
                                </TextBlock>
                                <TextBlock
                                    FontSize="12"
                                    Foreground="#B0B0B0"
                                    Text="âš¡ bá»‡nh nhÃ¢n/giÃ¢y" />
                            </StackPanel>
                        </Grid>

                        <!--  Cancel Button  -->
                        <Button
                            Grid.Row="11"
                            Width="120"
                            Height="40"
                            Margin="0,20,0,0"
                            HorizontalAlignment="Center"
                            Command="{Binding CancelBatchProcessingCommand}"
                            IsEnabled="{Binding CanCancelBatch}"
                            Style="{StaticResource MaterialDesignRaisedButton}">
                            <Button.Content>
                                <TextBlock
                                    FontSize="14"
                                    FontWeight="SemiBold"
                                    Text="Há»§y xá»­ lÃ½" />
                            </Button.Content>
                            <Button.Background>
                                <SolidColorBrush Color="#FF6B9D" />
                            </Button.Background>
                            <Button.Foreground>
                                <SolidColorBrush Color="#FFFFFF" />
                            </Button.Foreground>
                        </Button>
                    </Grid>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
