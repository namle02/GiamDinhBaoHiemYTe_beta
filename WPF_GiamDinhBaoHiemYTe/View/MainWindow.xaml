<Window
    x:Class="WPF_GiamDinhBaoHiem.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:control="clr-namespace:WPF_GiamDinhBaoHiem.View.ControlView"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:WPF_GiamDinhBaoHiem"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="Hệ thống Giám định Bảo hiểm Y tế"
    Width="1400"
    Height="800"
    Background="#cfcfcf"
    WindowStartupLocation="CenterScreen"
    mc:Ignorable="d">
    <materialDesign:DrawerHost
        x:Name="DrawerHost"
        BorderBrush="{DynamicResource MaterialDesignDivider}"
        BorderThickness="2"
        BottomDrawerBackground="{DynamicResource SecondaryHueLightBrush}"
        BottomDrawerCornerRadius="20 20 0 0">
        <materialDesign:DrawerHost.Style>
            <Style BasedOn="{StaticResource {x:Type materialDesign:DrawerHost}}" TargetType="materialDesign:DrawerHost">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding IsChecked, ElementName=BackgroundToggle}" Value="True">
                        <Setter Property="OverlayBackground" Value="{DynamicResource PrimaryHueMidBrush}" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </materialDesign:DrawerHost.Style>
        <materialDesign:DrawerHost.LeftDrawerContent>
            <!--  SideBar control  -->
            <control:SideBar Width="350" DataContext="{Binding SideBarVM}" />
        </materialDesign:DrawerHost.LeftDrawerContent>
        <Grid>
            <Grid.Resources>
                <BooleanToVisibilityConverter x:Key="BoolToVis"/>
            </Grid.Resources>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="auto" />
            </Grid.RowDefinitions>

            <!--  Thông báo có phiên bản mới (nằm trong MainWindow, góc trên)  -->
            <Border Grid.Row="0"
                    Background="White"
                    BorderBrush="{DynamicResource PrimaryHueMidBrush}"
                    BorderThickness="0,0,0,1"
                    Padding="16,12"
                    Visibility="{Binding ShowUpdateNotification, Converter={StaticResource BoolToVis}}">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="8" Opacity="0.2" ShadowDepth="1" Direction="270"/>
                </Border.Effect>
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                    <materialDesign:PackIcon Kind="Update"
                                             Width="24" Height="24"
                                             VerticalAlignment="Center"
                                             Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                    <TextBlock VerticalAlignment="Center"
                               Margin="10,0,16,0"
                               FontSize="14"
                               Text="{Binding UpdateNotificationVersion, StringFormat='Có phiên bản mới v{0}. Bạn có muốn cập nhật?', FallbackValue='Có phiên bản mới. Bạn có muốn cập nhật?'}"
                               TextWrapping="Wrap"/>
                    <Button Content="Để sau"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Width="90" Height="36" Margin="0,0,8,0"
                            Command="{Binding DismissUpdateNotificationCommand}"/>
                    <Button Content="Cập nhật"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Width="90" Height="36"
                            Command="{Binding GoToUpdatePageCommand}"/>
                </StackPanel>
            </Border>

            <!--  Header  -->
            <materialDesign:ColorZone Grid.Row="1"
                Background="White"
                Foreground="Black"
                Mode="Custom">
                <StackPanel Margin="16" Orientation="Horizontal">
                    <Button
                        Width="70"
                        Height="60"
                        Background="Transparent"
                        BorderBrush="Transparent"
                        Command="{x:Static materialDesign:DrawerHost.OpenDrawerCommand}"
                        CommandParameter="{x:Static Dock.Left}"
                        Style="{StaticResource MaterialDesignFlatLightBgButton}">
                        <Button.Content>
                            <materialDesign:PackIcon
                                Width="35"
                                Height="35"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Kind="Menu" />
                        </Button.Content>
                    </Button>
                    <Image
                        Width="70"
                        Height="70"
                        Source="/Assets/Logo_benh_vien-removebg-preview.png" />
                    <TextBlock
                        Width="370"
                        Margin="16,0"
                        VerticalAlignment="Center"
                        FontSize="25"
                        FontWeight="Bold"
                        Foreground="#475c70"
                        Text="HỆ THỐNG QUẢN TRỊ DỮ LIỆU THANH TOÁN BẢO HIỂM Y TẾ"
                        TextWrapping="Wrap" />
                </StackPanel>
            </materialDesign:ColorZone>


            <!--  Content  -->
            <ContentControl Grid.Row="2" Content="{Binding CurrentPage}" />

            <!--  Footer  -->
            <Grid Grid.Row="3"
                Height="60"
                Background="White" />
        </Grid>
    </materialDesign:DrawerHost>
</Window>
